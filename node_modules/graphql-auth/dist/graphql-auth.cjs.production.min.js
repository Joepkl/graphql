"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(e,r){var t=r||e;return function(n,o,u,i){try{var c,f=function(e){return s?e:t(n,o,u,i)},s=!1;if(!u.auth)return Promise.resolve(new Error("`auth` property not found on context!"));if(!u.auth.isAuthenticated)return Promise.resolve(new Error("Not authenticated!"));var a=!!r,h=function(){if(a){var r=function(){if(c&&c.length&&(!u.auth.scope||!function(e,r){var t=!1;return e.forEach((function(e){r.forEach((function(r){new RegExp("^"+r.replace("*",".*")+"$").exec(e)&&(t=!0)}))})),t}(c,u.auth.scope)))return s=!0,new Error("Permission denied!")},t=function(){if("function"==typeof e)return Promise.resolve(Promise.resolve((function(){return e(n,o,u,i)}))).then((function(e){c=e}));c=e}();return t&&t.then?t.then(r):r()}}();return Promise.resolve(h&&h.then?h.then(f):f(h))}catch(e){return Promise.reject(e)}}};
//# sourceMappingURL=graphql-auth.cjs.production.min.js.map
